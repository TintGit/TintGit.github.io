<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="keywords" content="iOS,OC,Objective-C,Swift,开发者,程序猿,程序媛,极客,编程,代码,开源,Developer">
<meta property="og:type" content="website">
<meta property="og:title" content="Unruly的博客">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="Unruly的博客">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Unruly的博客">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/2/"/>





  <title>Unruly的博客</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Unruly的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">心存善念，必有善行；善念善行，天必佑之。</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/29/Tips3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Unruly">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/assets/blogImg/mine.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Unruly的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/29/Tips3/" itemprop="url">iOS 知识小集(3)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-29T00:00:00+08:00">
                2018-07-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/知识小集/" itemprop="url" rel="index">
                    <span itemprop="name">知识小集</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p> resizableImage: 该方法可以指定一个矩形区域，这个图片在矩形内的部分会拉伸变形，而这个矩形区域外的部分则会保持原样。该方法有如下两个参数：<br>（1）withCapInsets：通过设置 UIEdgeInsets 的 left、right、top、bottom 来分别指定这个矩形区域距离左侧、右侧、顶部、底部的距离。</p>
<p>（2）resizingMode：设置矩形区域的拉伸变形模式，具体有如下两种：</p>
<ul>
<li>.stretch：拉伸模式，通过拉伸 UIEdgeInsets 指定的矩形区域来填充图片。 </li>
<li>.tile：平铺模式，通过重复显示 UIEdgeInsets 指定的矩形区域来填充图片。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">let imageView = UIImageView(frame: CGRect(x:10, y:100, width:300, height:66))</span><br><span class="line">let image = UIImage(named: &quot;bg&quot;)?</span><br><span class="line">    .resizableImage(withCapInsets: UIEdgeInsets(top: 0, left: 15, bottom: 0, right: 15),</span><br><span class="line">                    resizingMode: .stretch) //左右15像素的部分不变，中间部分来拉伸</span><br><span class="line">imageView.image = image</span><br><span class="line">view.addSubview(imageView)</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/25/WCDB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Unruly">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/assets/blogImg/mine.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Unruly的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/25/WCDB/" itemprop="url">WCDB</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-25T20:12:41+08:00">
                2018-07-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="模型绑定"><a href="#模型绑定" class="headerlink" title="模型绑定"></a>模型绑定</h2><blockquote>
<p>模型绑定（Object-relational Mapping，简称 ORM），通过对 Swift 类或结构进行绑定，形成类或结构 - 表模型、类或结构对象 - 表的映射关系，从而达到通过对象直接操作数据库的目的。</p>
</blockquote>
<ul>
<li>字段映射</li>
<li>字段约束</li>
<li>索引</li>
<li>表约束</li>
<li>虚拟表映射</li>
</ul>
<h3 id="字段映射"><a href="#字段映射" class="headerlink" title="字段映射"></a>字段映射</h3><blockquote>
<p>在类内定义 CodingKeys 的枚举类，并遵循 String 和CodingTableKey。枚举列举每一个需要定义的字段。</p>
</blockquote>
<p>1.别名映射 =&gt; case identifier = “id”</p>
<p>2.对于变量名与 SQLite 的保留关键字冲突 =&gt; case offset = “db_offset”</p>
<h3 id="字段约束"><a href="#字段约束" class="headerlink" title="字段约束"></a>字段约束</h3><blockquote>
<p>它用于定于针对单个字段的约束，如主键约束、非空约束、唯一约束、默认值等。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ColumnConstraintBinding(</span><br><span class="line">    isPrimary: Bool = false, // 该字段是否为主键。字段约束中只能同时存在一个主键</span><br><span class="line">    orderBy term: OrderTerm? = nil, // 当该字段是主键时，存储顺序是升序还是降序</span><br><span class="line">    isAutoIncrement: Bool = false, // 当该字段是主键时，其是否支持自增。只有整型数据可以定义为自增。</span><br><span class="line">    onConflict conflict: Conflict? = nil, // 当该字段是主键时，若产生冲突，应如何处理</span><br><span class="line">    isNotNull: Bool = false, // 该字段是否可以为空</span><br><span class="line">    isUnique: Bool = false, // 该字段是否可以具有唯一性</span><br><span class="line">    defaultTo defaultValue: ColumnDef.DefaultType? = nil // 该字段在数据库内使用什么默认值</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h4 id="自增"><a href="#自增" class="headerlink" title="自增"></a>自增</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">let autoIncrementObject = Sample()</span><br><span class="line">autoIncrementObject.isAutoIncrement = true</span><br><span class="line"></span><br><span class="line">// 插入自增数据</span><br><span class="line">try database.insert(objects: autoIncrementObject, intoTable: &quot;sampleTable&quot;)</span><br><span class="line">print(autoIncrementObject.lastInsertedRowID) // 输出 1</span><br><span class="line"></span><br><span class="line">// 再次插入自增数据</span><br><span class="line">try database.insert(objects: autoIncrementObject, intoTable: &quot;sampleTable&quot;)</span><br><span class="line">print(autoIncrementObject.lastInsertedRowID) // 输出 2</span><br><span class="line"></span><br><span class="line">// 插入非自增的指定数据</span><br><span class="line">let specificObject = Sample()</span><br><span class="line">specificObject.identifier = 10</span><br><span class="line">try database.insert(objects: specificObject, intoTable: &quot;sampleTable&quot;)</span><br></pre></td></tr></table></figure>
<h3 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h3><blockquote>
<p>它用于定于针对单个或多个字段的索引，索引后的数据在能有更高的查询效率。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">class Sample: TableCodable &#123;</span><br><span class="line">    var identifier: Int? = nil</span><br><span class="line">    var description: String? = nil</span><br><span class="line">    var multiIndexPart1: Int = 0</span><br><span class="line">    var multiIndexPart2: Int = 0</span><br><span class="line">        </span><br><span class="line">    enum CodingKeys: String, CodingTableKey &#123;</span><br><span class="line">        typealias Root = Sample</span><br><span class="line">        static let objectRelationalMapping = TableBinding(CodingKeys.self)</span><br><span class="line">        case identifier</span><br><span class="line">        case description</span><br><span class="line">        case multiIndexPart1</span><br><span class="line">        case multiIndexPart2</span><br><span class="line"></span><br><span class="line">        static var indexBindings: [IndexBinding.Subfix: IndexBinding]? &#123;</span><br><span class="line">            return [</span><br><span class="line">                &quot;_uniqueIndex&quot;: IndexBinding(isUnique: true, indexesBy: identifier),</span><br><span class="line">                &quot;_descendingIndex&quot;: IndexBinding(indexesBy: description.asIndex(orderBy: .descending)),</span><br><span class="line">                &quot;_multiIndex&quot;: IndexBinding(indexesBy: multiIndexPart1, multiIndexPart2.asIndex(orderBy: .ascending))</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>完整的索引名为表名+索引后缀，如：表 “sampleTable” 的索引分别为 “sampleTable_uniqueIndex”、”sampleTable_descendingIndex” 和 “sampleTable_multiIndex”。</p>
</blockquote>
<h3 id="表约束"><a href="#表约束" class="headerlink" title="表约束"></a>表约束</h3><blockquote>
<p>它用于定于针对多个字段或表本身的约束。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">class Sample: TableCodable &#123;</span><br><span class="line">    var identifier: Int? = nil</span><br><span class="line">    var multiPrimaryKeyPart1: Int = 0</span><br><span class="line">    var multiPrimaryKeyPart2: Int = 0</span><br><span class="line">    var multiUniquePart1: Int = 0</span><br><span class="line">    var multiUniquePart2: Int = 0</span><br><span class="line">        </span><br><span class="line">    enum CodingKeys: String, CodingTableKey &#123;</span><br><span class="line">        typealias Root = Sample</span><br><span class="line">        static let objectRelationalMapping = TableBinding(CodingKeys.self)</span><br><span class="line">        case identifier</span><br><span class="line">        case multiPrimaryKeyPart1</span><br><span class="line">        case multiPrimaryKeyPart2</span><br><span class="line">        case multiUniquePart1</span><br><span class="line">        case multiUniquePart2</span><br><span class="line"></span><br><span class="line">        static var tableConstraintBindings: [TableConstraintBinding.Name: TableConstraintBinding]? &#123;</span><br><span class="line">            let multiPrimaryBinding =</span><br><span class="line">                MultiPrimaryBinding(indexesBy: multiPrimaryKeyPart1.asIndex(orderBy: .descending), multiPrimaryKeyPart2)</span><br><span class="line">            let multiUniqueBinding =</span><br><span class="line">                MultiUniqueBinding(indexesBy: multiUniquePart1, multiUniquePart2.asIndex(orderBy: .ascending))</span><br><span class="line">            return [</span><br><span class="line">                &quot;MultiPrimaryConstraint&quot;: multiPrimaryBinding,</span><br><span class="line">                &quot;MultiUniqueConstraint&quot;: multiUniqueBinding</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>1.MultiPrimaryBinding: 联合主键约束</p>
<p>2.MultiUniqueBinding: 联合唯一约束</p>
<p>3.CheckBinding: 检查约束</p>
<p>4.ForeignKeyBinding: 外键约束</p>
<h3 id="虚拟表映射"><a href="#虚拟表映射" class="headerlink" title="虚拟表映射"></a>虚拟表映射</h3><blockquote>
<p>它用于定于虚拟表以进行全文搜索等特性。</p>
</blockquote>
<h2 id="增删改查"><a href="#增删改查" class="headerlink" title="增删改查"></a>增删改查</h2><h3 id="插入操作"><a href="#插入操作" class="headerlink" title="插入操作"></a>插入操作</h3><blockquote>
<p>插入操作有 “insert” 和 “insertOrReplace” 两个接口。故名思义，前者只是单纯的插入数据，当数据出现冲突时会失败，而后者在主键一致时，新数据会覆盖旧数据。<br>propertyConvertibleList 插入指定字段</p>
</blockquote>
<h3 id="删除操作"><a href="#删除操作" class="headerlink" title="删除操作"></a>删除操作</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">func delete(fromTable table: String, // 表名</span><br><span class="line">            where condition: Condition? = nil, // 符合删除的条件</span><br><span class="line">            orderBy orderList: [OrderBy]? = nil, // 排序的方式</span><br><span class="line">            limit: Limit? = nil, // 删除的个数</span><br><span class="line">            offset: Offset? = nil // 从第几个开始删除</span><br><span class="line">) throws</span><br></pre></td></tr></table></figure>
<blockquote>
<p>将 table 表内，满足 condition 的数据，按照 orderList 的方式进行排序，然后从头开始第 offset 行数据后的 limit 行数据删除</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">// 删除 sampleTable 中所有 identifier 大于 1 的行的数据</span><br><span class="line">try database.delete(fromTable: &quot;sampleTable&quot;, </span><br><span class="line">                    where: Sample.Properties.identifier &gt; 1)</span><br><span class="line"></span><br><span class="line">// 删除 sampleTable 中 identifier 降序排列后的前 2 行数据</span><br><span class="line">try database.delete(fromTable: &quot;sampleTable&quot;, </span><br><span class="line">                    orderBy: Sample.Properties.identifier.asOrder(by: .descending), </span><br><span class="line">                    limit: 2)</span><br><span class="line"></span><br><span class="line">// 删除 sampleTable 中 description 非空的数据，按 identifier 降序排列后的前 3 行的后 2 行数据</span><br><span class="line">try database.delete(fromTable: &quot;sampleTable&quot;, </span><br><span class="line">                    where: Sample.Properties.description.isNotNull(), </span><br><span class="line">                    orderBy: Sample.Properties.identifier.asOrder(by: .descending), </span><br><span class="line">                    limit: 2,</span><br><span class="line">                    offset: 3)</span><br><span class="line"></span><br><span class="line">// 删除 sampleTable 中的所有数据</span><br><span class="line">try database.delete(fromTable: &quot;sampleTable&quot;)</span><br></pre></td></tr></table></figure>
<h3 id="更新操作"><a href="#更新操作" class="headerlink" title="更新操作"></a>更新操作</h3><blockquote>
<p>update with object<br>update with row</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">let object = Sample()</span><br><span class="line">object.description = &quot;update&quot;</span><br><span class="line"></span><br><span class="line">// 将 sampleTable 中所有 identifier 大于 1 且 description 字段不为空 的行的 description 字段更新为 &quot;update&quot;</span><br><span class="line">try database.update(table: &quot;sampleTable&quot;</span><br><span class="line">                    on: Sample.Properties.description,</span><br><span class="line">                    with: object,</span><br><span class="line">                    where: Sample.Properites.identifier &gt; 1 &amp;&amp; Sample.Properties.description.isNotNull())</span><br><span class="line"></span><br><span class="line">// 将 sampleTable 中前三行的 description 字段更新为 &quot;update&quot;</span><br><span class="line">try database.update(table: &quot;sampleTable&quot;</span><br><span class="line">                    on: Sample.Properties.description,</span><br><span class="line">                    with: object,</span><br><span class="line">                    limit: 3)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">let row: [ColumnCodableBase] = [&quot;update&quot;]</span><br><span class="line"></span><br><span class="line">// 将 sampleTable 中所有 identifier 大于 1 且 description 字段不为空 的行的 description 字段更新为 &quot;update&quot;</span><br><span class="line">try database.update(table: &quot;sampleTable&quot;</span><br><span class="line">                    on: Sample.Properties.description,</span><br><span class="line">                    with: row,</span><br><span class="line">                    where: Sample.Properites.identifier &gt; 1 &amp;&amp; Sample.Properties.description.isNotNull())</span><br><span class="line"></span><br><span class="line">// 将 sampleTable 中前三行的 description 字段更新为 &quot;update&quot;</span><br><span class="line">try database.update(table: &quot;sampleTable&quot;</span><br><span class="line">                    on: Sample.Properties.description,</span><br><span class="line">                    with: row,</span><br><span class="line">                    limit: 3)</span><br></pre></td></tr></table></figure>
<h3 id="查找操作"><a href="#查找操作" class="headerlink" title="查找操作"></a>查找操作</h3><ul>
<li>getObjects</li>
<li>getObject</li>
<li>getRows</li>
<li>getRow</li>
<li>getColumn</li>
<li>getDistinctColumn</li>
<li>getValue</li>
<li>getDistinctValue</li>
</ul>
<h4 id="对象查找"><a href="#对象查找" class="headerlink" title="对象查找"></a>对象查找</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// 返回 sampleTable 中的所有数据</span><br><span class="line">let allObjects: [Sample] = try database.getObjects(fromTable: &quot;sampleTable&quot;)</span><br><span class="line"></span><br><span class="line">// 返回 sampleTable 中 identifier 小于 5 或 大于 10 的行的数据</span><br><span class="line">let objects: [Sample] = try database.getObjects(fromTable: &quot;sampleTable&quot;, </span><br><span class="line">                                                where: Sample.Properties.identifier &lt; 5 || Sample.Properties.identifier &gt; 10)</span><br><span class="line"></span><br><span class="line">// 返回 sampleTable 中 identifier 最大的行的数据</span><br><span class="line">let object: Sample? = try database.getObject(fromTable: &quot;sampleTable&quot;, </span><br><span class="line">                                             orderBy: Sample.Properties.identifier.asOrder(by: .descending))</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意: 由于对象查找操作使用了范型，因此需要显式声明返回值的类型以匹配范型</p>
</blockquote>
<h4 id="对象部分查询"><a href="#对象部分查询" class="headerlink" title="对象部分查询"></a>对象部分查询</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">let objects: [Sample] = try database.getObjects(fromTable: &quot;sampleTable&quot;, </span><br><span class="line">                                                on: Sample.Properties.identifier)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意:这里只获取了 identifier 字段，而没有获取 description 的值。这就可能与 Swift 本身存在冲突。 Swift 规定了对象创建时，必须初始化所有成员变量。而进行对象部分查询时，则可能出现某部分变量没有变查询，因此无法初始化的情况。因此，对于可能不被查询的成员变量，应将其类型定义为可选值。<br>倘若开发者不确定哪些字段可能会被进行对象部分查询，可以将所有字段都定义为可选。</p>
</blockquote>
<h4 id="值查询操作"><a href="#值查询操作" class="headerlink" title="值查询操作"></a>值查询操作</h4><table>
<thead>
<tr>
<th>identifier</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>“sample1”</td>
</tr>
<tr>
<td>2</td>
<td>“sample2”</td>
</tr>
<tr>
<td>3</td>
<td>“sample3”</td>
</tr>
<tr>
<td>4</td>
<td>“sample4”</td>
</tr>
<tr>
<td>5</td>
<td>“sample5”</td>
</tr>
<tr>
<td>6</td>
<td>“sample6”</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>getRows</strong> 接口获取整个矩阵的所有内容，即返回值为二维数组。</li>
<li><strong>getRow</strong> 接口获取某一横行的数据，即返回值为一维数组。</li>
<li><strong>getColumn</strong> 接口获取某一纵列的数据，即返回值为一维数组。</li>
<li><strong>getDistinctColumn</strong> 与 <strong>getColumn</strong> 类似，但它会过滤掉重复的值。</li>
<li><strong>getValue</strong> 接口获取矩阵中某一个格的内容。</li>
<li><strong>getDistinctValue</strong> 与 <strong>getValue</strong> 类似，但它会过滤掉重复的值。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">// 获取所有内容</span><br><span class="line">let allRows = try database.getRows(fromTable: &quot;sampleTable&quot;)</span><br><span class="line">print(allRows[row: 2, column: 0].int32Value) // 输出 3</span><br><span class="line"></span><br><span class="line">// 获取第二行</span><br><span class="line">let secondRow = try database.getRow(fromTable: &quot;sampleTable&quot;, offset: 1)</span><br><span class="line">print(secondRow[0].int32Value) // 输出 2</span><br><span class="line"></span><br><span class="line">// 获取 description 列</span><br><span class="line">let descriptionColumn = try database.getColumn(on: Sample.Properties.description, fromTable: &quot;sampleTable&quot;)</span><br><span class="line">print(descriptionColumn) // 输出 &quot;sample1&quot;, &quot;sample1&quot;, &quot;sample1&quot;, &quot;sample2&quot;, &quot;sample2&quot; </span><br><span class="line"></span><br><span class="line">// 获取不重复的 description 列的值</span><br><span class="line">let distinctDescriptionColumn = try database.getDistinctColumn(on: Sample.Properties.description, fromTable: &quot;sampleTable&quot;)</span><br><span class="line">print(distinctDescriptionColumn) // 输出 &quot;sample1&quot;, &quot;sample2&quot;</span><br><span class="line"></span><br><span class="line">// 获取第二行 description 列的值</span><br><span class="line">let value = try database.getValue(on: Sample.Properties.description, offset: 1)</span><br><span class="line">print(value.stringValue) // 输出 &quot;sample1&quot;</span><br><span class="line"></span><br><span class="line">// 获取 identifier 的最大值</span><br><span class="line">let maxIdentifier = try database.getValue(on: Sample.Properties.identifier.max(), fromTable: &quot;sampleTable&quot;)</span><br><span class="line"></span><br><span class="line">// 获取不重复的 description 的值</span><br><span class="line">let distinctDescription = try database.getDistinctValue(on: Sample.Properties.description, fromTable: &quot;sampleTable&quot;)</span><br><span class="line">print(distinctDescription.stringValue) // 输出 &quot;sample1&quot;</span><br></pre></td></tr></table></figure>
<h2 id="数据库、表、事物"><a href="#数据库、表、事物" class="headerlink" title="数据库、表、事物"></a>数据库、表、事物</h2><blockquote>
<p>数据库 - <code>Database</code>、表 - <code>Table</code> 和 事务 - <code>Transaction</code></p>
</blockquote>
<ul>
<li>支持增删查改的便捷接口</li>
<li>支持链式接口</li>
<li>数据和状态共享</li>
<li>线程安全</li>
</ul>
<p><strong>数据和状态共享</strong>，意味着对于 同一个路径的数据库 的 不同基础类，它们的标签、数据库是否打开、是否在进行读写操作等所有状态和数据都始终保持一致。</p>
<p><strong>线程安全</strong>，意味着开发者可以在 任意线程 对 任意基础类 调用 任意接口，而不需要考虑数据库本身的线程安全问题。同时，WCDB Swift 会根据调用情况，并发执行操作，以达到更高的性能</p>
<p><a href="https://github.com/Tencent/wcdb/wiki/Swift-%E6%95%B0%E6%8D%AE%E5%BA%93%E3%80%81%E8%A1%A8%E3%80%81%E4%BA%8B%E5%8A%A1" target="_blank" rel="noopener">文档</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/25/杭州游玩攻略/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Unruly">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/assets/blogImg/mine.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Unruly的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/25/杭州游玩攻略/" itemprop="url">杭州游玩美食攻略</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-25T20:12:40+08:00">
                2018-07-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>自古就有“上有天堂，下有苏杭”的美誉。</p>
<p>鱼米之乡、丝绸之府、 文物之邦，</p>
<p>都是世人对杭州的唯美印象。</p>
<p>整理了杭州的旅游攻略，想去杭州旅游的小伙伴们看过来吧！</p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2018/07/25/杭州游玩攻略/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/25/组件化实践/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Unruly">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/assets/blogImg/mine.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Unruly的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/25/组件化实践/" itemprop="url">组件化实践</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-25T20:12:31+08:00">
                2018-07-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>组件化大体思路<br><img src="https://upload-images.jianshu.io/upload_images/1064540-f949b35414955594.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/665" alt="持续集成"></p>
<p>框架说明:</p>
<ul>
<li>持续集成: 主工程(壳工程),包含所有内容，用于发布打包等</li>
<li>基础组件: 不依赖其他任何组件，独立完成功能。主要有：与业务无法的功能（如string或data的加密，category的封装）对第三方库的封装（如AFNetworking，SDWebImage的封装）</li>
<li>业务公用组件: 依赖基础组件或UIKit等系统组件，创建业务共同使用的功能（如分享，支付，网络访问）</li>
<li>中间组件: 连接业务公用组件和业务组件，及业务组件之间的互相调用。（如Mediator的组件）</li>
<li>业务组件：单独的业务功能，不依赖其他业务组件。</li>
</ul>
<p>##基础组件：<br>没有业务场景 不允许依赖业务组件</p>
<p>###公共基础<br>多项目可用</p>
<p>###非公共基础<br>ProjectA依赖，但是ProjectB不依赖</p>
<h2 id="桥接层"><a href="#桥接层" class="headerlink" title="桥接层"></a>桥接层</h2><ul>
<li>桥接层的主要作用是为上层业务层和下层基础框架层做桥接，主要考虑底层业务层的开放接口变动频繁以及不适配上层业务。</li>
<li>想要达到每个组件之间相对低耦合，比较常用的方案就是断掉<strong>横向依赖</strong>，使用中间人模式将依赖下沉至<strong>中间件</strong>，而且组件对中间件是<strong>单向依赖</strong></li>
</ul>
<p>##业务组件<br>业务之间不允许相互依赖</p>
<p>隐性依赖库 -&gt; Podfile.lock</p>
<p>##过程</p>
<p>开源组件-&gt;基础组件-&gt;平台中间件-&gt;业务组件-&gt;壳工程</p>
<p>副作用：因为多库开发在发布与集成时 很多依赖冲突lock文件冲突</p>
<p>自动发版与自动集成</p>
<p>壳工程分离</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/03/面试/面试 - 多线程/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Unruly">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/assets/blogImg/mine.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Unruly的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/03/面试/面试 - 多线程/" itemprop="url">拾遗 - 多线程</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-03T00:00:00+08:00">
                2018-07-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/拾遗/" itemprop="url" rel="index">
                    <span itemprop="name">拾遗</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="对比"><a href="#对比" class="headerlink" title="对比"></a>对比</h2><ul>
<li>GCD是面向底层的C语言的API，NSOpertaionQueue用GCD构建封装的，是GCD的高级抽象</li>
<li>GCD只支持FIFO队列</li>
<li>NSOperationQueue可设置最大并发数、设置优先级、设置依赖关系等调整执行顺序</li>
<li>NSThread需要我们自己去管理线程的生命周期，还要考虑线程同步、加锁问题，造成一些性能上的开销</li>
</ul>
<h2 id="死锁"><a href="#死锁" class="headerlink" title="死锁"></a>死锁</h2><p>一定是发生在一个或多个线程之间的。那么死锁和线程阻塞的关系呢，可以这么理解，双向的阻塞导致了死锁</p>
<p>多个进程因循环等待资源而造成无法执行的现象</p>
<h3 id="主队列同步"><a href="#主队列同步" class="headerlink" title="主队列同步"></a>主队列同步</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">override func viewDidLoad() &#123;</span><br><span class="line">  	super.viewDidLoad()</span><br><span class="line"></span><br><span class="line">    DispatchQueue.main.sync &#123;</span><br><span class="line">    	print(&quot;deadlock&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">或者</span><br><span class="line">dispatch_queue_t serialQueue = dispatch_queue_create(&quot;test&quot;, DISPATCH_QUEUE_SERIAL);</span><br><span class="line"></span><br><span class="line">dispatch_async(serialQueue, ^&#123;</span><br><span class="line">       </span><br><span class="line">        dispatch_sync(serialQueue, ^&#123;</span><br><span class="line">            </span><br><span class="line">            NSLog(@&quot;deadlock&quot;);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>
<p>解决： 异步或者其它队列</p>
<h2 id="GCD"><a href="#GCD" class="headerlink" title="GCD"></a>GCD</h2><h3 id="执行顺序：串行队列先异步后同步"><a href="#执行顺序：串行队列先异步后同步" class="headerlink" title="执行顺序：串行队列先异步后同步"></a>执行顺序：串行队列先异步后同步</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">dispatch_queue_t serialQueue = dispatch_queue_create(&quot;test&quot;, DISPATCH_QUEUE_SERIAL);</span><br><span class="line">    </span><br><span class="line">    NSLog(@&quot;1&quot;);</span><br><span class="line">    </span><br><span class="line">    dispatch_async(serialQueue, ^&#123;</span><br><span class="line">        </span><br><span class="line">         NSLog(@&quot;2&quot;);</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    NSLog(@&quot;3&quot;);</span><br><span class="line">    </span><br><span class="line">    dispatch_sync(serialQueue, ^&#123;</span><br><span class="line">        </span><br><span class="line">        NSLog(@&quot;4&quot;);</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    NSLog(@&quot;5&quot;);</span><br></pre></td></tr></table></figure>
<p>打印顺序是13245</p>
<p>首先先打印1<br>接下来将任务2其添加至串行队列上，由于任务2是异步，不会阻塞线程，继续向下执行，打印3<br>然后是任务4,将任务4添加至串行队列上，因为任务4和任务2在同一串行队列，根据队列先进先出原则，任务4必须等任务2执行后才能执行，又因为任务4是同步任务，会阻塞线程，只有执行完任务4才能继续向下执行打印5</p>
<p>所以最终顺序就是13245。<br>这里的任务4在主线程中执行，而任务2在子线程中执行。<br>如果任务4是添加到另一个串行队列或者并行队列，则任务2和任务4无序执行(可以添加多个任务看效果)</p>
<h3 id="dispatch-barrier-sync-栅栏函数"><a href="#dispatch-barrier-sync-栅栏函数" class="headerlink" title="dispatch_barrier_sync(栅栏函数)"></a>dispatch_barrier_sync(栅栏函数)</h3><p>场景多读单写：可以多个读者同时读取数据，而在读的时候，不能取写入数据。并且，在写的过程中，不能有其他写者去写。即读者之间是并发的，写者与读者或其他写者是互斥的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">- (id)readDataForKey:(NSString *)key</span><br><span class="line">&#123;</span><br><span class="line">    __block id result;</span><br><span class="line">    </span><br><span class="line">    dispatch_sync(_concurrentQueue, ^&#123;</span><br><span class="line">       </span><br><span class="line">        result = [self valueForKey:key];</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    return result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)writeData:(id)data forKey:(NSString *)key</span><br><span class="line">&#123;</span><br><span class="line">    dispatch_barrier_async(_concurrentQueue, ^&#123;</span><br><span class="line">       </span><br><span class="line">        [self setValue:data forKey:key];</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="dispatch-group-async"><a href="#dispatch-group-async" class="headerlink" title="dispatch_group_async"></a>dispatch_group_async</h3><p>场景：在n个耗时并发任务都完成后，再去执行接下来的任务。比如，在n个网络请求完成后去刷新UI页面</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">dispatch_queue_t concurrentQueue = dispatch_queue_create(&quot;test1&quot;, DISPATCH_QUEUE_CONCURRENT);</span><br><span class="line"></span><br><span class="line">    dispatch_group_t group = dispatch_group_create();</span><br><span class="line">    </span><br><span class="line">    for (NSInteger i = 0; i &lt; 10; i++) &#123;</span><br><span class="line">        </span><br><span class="line">        dispatch_group_async(group, concurrentQueue, ^&#123;</span><br><span class="line">            </span><br><span class="line">            sleep(1);</span><br><span class="line">            </span><br><span class="line">            NSLog(@&quot;%zd:网络请求&quot;,i);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    dispatch_group_notify(group, dispatch_get_main_queue(), ^&#123;</span><br><span class="line">        </span><br><span class="line">        NSLog(@&quot;刷新页面&quot;);</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>
<h3 id="Dispatch-Semaphore（信号量）"><a href="#Dispatch-Semaphore（信号量）" class="headerlink" title="Dispatch Semaphore（信号量）"></a>Dispatch Semaphore（信号量）</h3><ul>
<li>保持线程同步，将异步执行任务转换为同步执行任务</li>
<li>保证线程安全，为线程加锁</li>
</ul>
<h3 id="dispatch-after（延时函数）"><a href="#dispatch-after（延时函数）" class="headerlink" title="dispatch_after（延时函数）"></a>dispatch_after（延时函数）</h3><h3 id="dispatch-once（单例）"><a href="#dispatch-once（单例）" class="headerlink" title="dispatch_once（单例）"></a>dispatch_once（单例）</h3><h2 id="面试题"><a href="#面试题" class="headerlink" title="面试题"></a>面试题</h2><p><a href="https://www.jianshu.com/p/c6ebcc200ce2" target="_blank" rel="noopener">执行顺序</a></p>
<h2 id="NSThread-runloop实现常驻线程"><a href="#NSThread-runloop实现常驻线程" class="headerlink" title="NSThread+runloop实现常驻线程"></a>NSThread+runloop实现常驻线程</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">+ (NSThread *)shareThread &#123;</span><br><span class="line">    </span><br><span class="line">    static NSThread *shareThread = nil;</span><br><span class="line">    </span><br><span class="line">    static dispatch_once_t oncePredicate;</span><br><span class="line">    </span><br><span class="line">    dispatch_once(&amp;oncePredicate, ^&#123;</span><br><span class="line">        </span><br><span class="line">        shareThread = [[NSThread alloc] initWithTarget:self selector:@selector(threadTest2) object:nil];</span><br><span class="line">        </span><br><span class="line">        [shareThread setName:@&quot;threadTest&quot;];</span><br><span class="line">        </span><br><span class="line">        [shareThread start];</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    return shareThread;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (void)threadTest</span><br><span class="line">&#123;</span><br><span class="line">    @autoreleasepool &#123;</span><br><span class="line">        </span><br><span class="line">        NSRunLoop *runLoop = [NSRunLoop currentRunLoop];</span><br><span class="line">        </span><br><span class="line">        [runLoop addPort:[NSMachPort port] forMode:NSDefaultRunLoopMode];</span><br><span class="line">        </span><br><span class="line">        [runLoop run];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="锁"><a href="#锁" class="headerlink" title="锁"></a>锁</h2><h3 id="自旋锁"><a href="#自旋锁" class="headerlink" title="自旋锁"></a>自旋锁</h3><p>是一种用于保护多线程共享资源的锁，与一般互斥锁（mutex）不同之处在于当自旋锁尝试获取锁时以忙等待（busy waiting）的形式不断地循环检查锁是否可用。当上一个线程的任务没有执行完毕的时候（被锁住），那么下一个线程会一直等待（不会睡眠），当上一个线程的任务执行完毕，下一个线程会立即执行。<br>在多CPU的环境中，对持有锁较短的程序来说，使用自旋锁代替一般的互斥锁往往能够提高程序的性能。</p>
<h3 id="互斥锁"><a href="#互斥锁" class="headerlink" title="互斥锁"></a>互斥锁</h3><p>当上一个线程的任务没有执行完毕的时候（被锁住），那么下一个线程会进入睡眠状态等待任务执行完毕，当上一个线程的任务执行完毕，下一个线程会自动唤醒然后执行任务。</p>
<h2 id="对比-1"><a href="#对比-1" class="headerlink" title="对比"></a>对比</h2><p>自旋锁的优点在于，因为自旋锁不会引起调用者睡眠，所以不会进行线程调度，CPU时间片轮转等耗时操作。所有如果能在很短的时间内获得锁，自旋锁的效率远高于互斥锁。<br>　　缺点在于，自旋锁一直占用CPU，他在未获得锁的情况下，一直运行－－自旋，所以占用着CPU，如果不能在很短的时 间内获得锁，这无疑会使CPU效率降低。自旋锁不能实现递归调用。</p>
<ul>
<li>自旋锁：atomic、OSSpinLock、dispatch_semaphore_t</li>
<li>互斥锁：pthread_mutex、@ synchronized、NSLock、NSConditionLock 、NSCondition、NSRecursiveLock<br>。</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/02/面试/面试 - 内存/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Unruly">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/assets/blogImg/mine.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Unruly的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/02/面试/面试 - 内存/" itemprop="url">拾遗 - 内存</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-02T00:00:00+08:00">
                2018-07-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/拾遗/" itemprop="url" rel="index">
                    <span itemprop="name">拾遗</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Autorelease-Pool"><a href="#Autorelease-Pool" class="headerlink" title="Autorelease Pool"></a>Autorelease Pool</h2><h3 id="autoreleasepool结构"><a href="#autoreleasepool结构" class="headerlink" title="@autoreleasepool结构"></a>@autoreleasepool结构</h3><p>单个 autoreleasepool 的运行过程可以简单地理解为 objc_autoreleasePoolPush()、[对象 autorelease] 和 objc_autoreleasePoolPop(void *) 三个过程</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">struct __AtAutoreleasePool &#123;</span><br><span class="line">  __AtAutoreleasePool() &#123;atautoreleasepoolobj = objc_autoreleasePoolPush();&#125;</span><br><span class="line">  ~__AtAutoreleasePool() &#123;objc_autoreleasePoolPop(atautoreleasepoolobj);&#125;</span><br><span class="line">  void * atautoreleasepoolobj;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="组成"><a href="#组成" class="headerlink" title="组成"></a>组成</h3><p>每一个自动释放池都是由一系列的 AutoreleasePoolPage 组成的，并且每一个 AutoreleasePoolPage 的大小都是 4096 字节（16 进制 0x1000）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">class AutoreleasePoolPage &#123;</span><br><span class="line">    magic_t const magic;</span><br><span class="line">    id *next;</span><br><span class="line">    pthread_t const thread;</span><br><span class="line">    AutoreleasePoolPage * const parent;</span><br><span class="line">    AutoreleasePoolPage *child;</span><br><span class="line">    uint32_t const depth;</span><br><span class="line">    uint32_t hiwat;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="双向链表"><a href="#双向链表" class="headerlink" title="双向链表"></a>双向链表</h3><p>自动释放池中的 AutoreleasePoolPage 是以双向链表的形式连接起来的</p>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><ul>
<li>自动释放池是由 AutoreleasePoolPage 以双向链表的方式实现的</li>
<li>当对象调用 autorelease 方法时，会将对象加入 AutoreleasePoolPage 的栈中</li>
<li>调用 AutoreleasePoolPage::pop 方法会向栈中的对象发送 release 消息</li>
<li>每个线程有一个Runloop 每个Runloop有一个Autorelease Pool</li>
</ul>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="https://draveness.me/autoreleasepool" target="_blank" rel="noopener">自动释放池的前世今生 —- 深入解析 autoreleasepool</a></li>
<li><a href="https://blog.sunnyxx.com/2014/10/15/behind-autorelease/" target="_blank" rel="noopener">黑幕背后的Autorelease</a></li>
</ul>
<h3 id="什么时候释放"><a href="#什么时候释放" class="headerlink" title="什么时候释放"></a>什么时候释放</h3><p>在没有手加Autorelease Pool的情况下，Autorelease对象是在当前的runloop迭代结束时释放的，而它能够释放的原因是系统在每个runloop迭代中都加入了自动释放池Push和Pop （drain）</p>
<h2 id="循环引用"><a href="#循环引用" class="headerlink" title="循环引用"></a>循环引用</h2><ul>
<li>delegate</li>
<li>Timer</li>
<li>Block</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/01/面试/面试 - Runtime运行时拾遗/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Unruly">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/assets/blogImg/mine.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Unruly的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/01/面试/面试 - Runtime运行时拾遗/" itemprop="url">拾遗 - Runtime</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-01T00:00:00+08:00">
                2018-07-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/拾遗/" itemprop="url" rel="index">
                    <span itemprop="name">拾遗</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/06/30/面试/面试 - OC语言特性/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Unruly">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/assets/blogImg/mine.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Unruly的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/30/面试/面试 - OC语言特性/" itemprop="url">拾遗 - OC语言特性</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-30T00:00:00+08:00">
                2018-06-30
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/拾遗/" itemprop="url" rel="index">
                    <span itemprop="name">拾遗</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="动态性（Dynamic）"><a href="#动态性（Dynamic）" class="headerlink" title="动态性（Dynamic）"></a>动态性（Dynamic）</h2><ul>
<li><code>-</code> 动态类型<ul>
<li>指的是对象指针类型的动态性、具体是指使用id任意类型将对象的类型确定推迟到运行时 </li>
<li>动态类型识别 isKindOfClass</li>
</ul>
</li>
<li><code>-</code> 动态绑定<ul>
<li>核心是在运行时动态的为类添加属性和方法</li>
<li>消息传递机制</li>
</ul>
</li>
<li><code>-</code> 动态加载<ul>
<li>动态资源加载</li>
<li>可执行代码模块的加载</li>
</ul>
</li>
</ul>
<h2 id="成员变量和属性"><a href="#成员变量和属性" class="headerlink" title="成员变量和属性"></a>成员变量和属性</h2><p>属性：成员变量+setter+getter</p>
<h2 id="Category（类别-分类-类目）"><a href="#Category（类别-分类-类目）" class="headerlink" title="Category（类别/分类/类目）"></a>Category（类别/分类/类目）</h2><h3 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h3><ul>
<li>多人维护同一个类</li>
<li>为已经存在的类添加方法</li>
<li>声明私有方法</li>
<li>模拟多继承</li>
<li>把frameowork的私有方法公开</li>
</ul>
<h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h3><ul>
<li>分类只能添加方法 不能增加成员变量</li>
<li>分类同名的方法会覆盖原来的方法（原来的方法还有只是在顺序列表的后面）</li>
<li>分类方法中不可以调用super</li>
<li>相同方法的优先级 分类（最后编译的分类优先）-&gt; 原类 -&gt; 父类</li>
<li>分类是runtime时加载 不是编译时</li>
<li>分类可通过runtime 关联对象 添加属性（类别中添加@property描述的属性，（只会生成这个属性的set,get方法的声明,也就不是会实现.）这时候编译是没问题的没警告没报错，但是一旦在创建对象后为属性赋值或者使用这个属性的时候，程序就崩溃了，奔溃的原因也很简单，就是找不到属性的set/get方法）</li>
</ul>
<h2 id="Extension（扩展）"><a href="#Extension（扩展）" class="headerlink" title="Extension（扩展）"></a>Extension（扩展）</h2><ul>
<li>为一个类添加额外的原来没有变量，方法和属性</li>
<li>一般的类扩展写到.m文件中</li>
<li>一般的私有属性写到.m文件中的类扩展中</li>
</ul>
<h2 id="Category-和-Extension-区别"><a href="#Category-和-Extension-区别" class="headerlink" title="Category 和 Extension 区别"></a>Category 和 Extension 区别</h2><ul>
<li>Class Extension 在编译期就会将定义的 Ivar、属性、方法等直接合入主类，而 Category 在程序启动 Runtime Loading 时才会将属性（没 Ivar）和方法合入主类</li>
<li>Class Extension 是匿名的 Category</li>
<li>主要的区别在于，对于扩展，编译器将期望您在主@implementation中实现方法，而对于类别，您有一个单独的@implementation块</li>
</ul>
<h2 id="Delegate"><a href="#Delegate" class="headerlink" title="Delegate"></a>Delegate</h2><p>使用weak 防止循环引用</p>
<h2 id="NSNotification"><a href="#NSNotification" class="headerlink" title="NSNotification"></a>NSNotification</h2><p>观察者模式</p>
<h2 id="KVO-Key-value-observing"><a href="#KVO-Key-value-observing" class="headerlink" title="KVO(Key-value observing)"></a>KVO(Key-value observing)</h2><p>观察者模式</p>
<h3 id="实现原理"><a href="#实现原理" class="headerlink" title="实现原理"></a>实现原理</h3><blockquote>
<p>Apple 使用了 isa 混写（isa-swizzling）来实现 KVO 。当观察对象A时，KVO机制动态创建一个新的名为：NSKVONotifying_A 的派生类，并将被观察对象的isa 指向这个派生类，该类继承自对象A的本类，且 KVO 为 NSKVONotifying_A 重写观察属性的 setter 方法，setter 方法会负责在调用原 setter 方法之前和之后，通知所有观察对象属性值的更改情况。<br>（备注： isa 混写（isa-swizzling）isa：is a kind of ； swizzling：混合，搅合；）</p>
</blockquote>
<h3 id="注意-1"><a href="#注意-1" class="headerlink" title="注意"></a>注意</h3><p>必须继承NSObject 因为NSObject可监听值的变化 NSKeyValueObserving</p>
<h3 id="KVC（Key-value-Coding）"><a href="#KVC（Key-value-Coding）" class="headerlink" title="KVC（Key-value Coding）"></a>KVC（Key-value Coding）</h3><ul>
<li>动态set、get</li>
<li>访问私有属性</li>
<li>KVC和Objc的runtime组合可以很容易的实现Model和字典的转换</li>
<li>KVO是基于KVC实现的</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/06/26/创建私有SepcRepo/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Unruly">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/assets/blogImg/mine.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Unruly的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/26/创建私有SepcRepo/" itemprop="url">Sepc Repo</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-26T00:00:00+08:00">
                2018-06-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="创建私有-Sepc-Repo"><a href="#创建私有-Sepc-Repo" class="headerlink" title="创建私有 Sepc Repo"></a>创建私有 Sepc Repo</h3><p>CocoaPods对于一名iOS开发来说再熟悉不过了，它的工作原理就是在GitHub上面有个<strong>Spec Repo</strong>，它里面包括成千上万的<strong>podspec</strong>文件索引目录。然后我们在项目集成的时候可以通过它去找到我们需要的开源代码。其实CocoaPods的<strong>Spec Repo</strong>就是一个中介。</p>
<ul>
<li>The Specs Repo is the repository on GitHub that contains the list of all available pods. Every library has an individual folder, which contains sub folders of the available versions of that pod.</li>
</ul>
<p>创建私有 <strong>Spec Repo</strong>，然后把我们公共组件的<strong>podspec</strong>文件放在里面，然后集成的时候让CocoaPods帮我们集成那我们就能达到目的</p>
<p>私有 Spec 仓库需要在 git 托管平台托管，现有的免费私有仓库有 Coding、CSDN 以及自己搭建 Gitlab，本文选用 Gitlab 托管平台演示如何进行组件化开发。</p>
<h4 id="进入-cocoapods-repos-查看已经存在的spec-repo"><a href="#进入-cocoapods-repos-查看已经存在的spec-repo" class="headerlink" title="进入 ./cocoapods/repos 查看已经存在的spec repo"></a>进入 ./cocoapods/repos 查看已经存在的spec repo</h4><ul>
<li>cd ./cocoapods/repos</li>
<li>ls -l</li>
</ul>
<h4 id="在私有git服务器上创建自己的sepc-repo"><a href="#在私有git服务器上创建自己的sepc-repo" class="headerlink" title="在私有git服务器上创建自己的sepc repo"></a>在私有git服务器上创建自己的sepc repo</h4><ul>
<li>创建项目 获取访问地址 <a href="https://git.xxx.cn/TestSpecs.git" target="_blank" rel="noopener">https://git.xxx.cn/TestSpecs.git</a></li>
<li>终端执行 pod repo add [本地名字] <a href="https://git.xxx.cn/TestSpecs.git" target="_blank" rel="noopener">https://git.xxx.cn/TestSpecs.git</a></li>
<li>ls -l 或者 pod repo list 查看</li>
</ul>
<h3 id="创建Pods仓库"><a href="#创建Pods仓库" class="headerlink" title="创建Pods仓库"></a>创建Pods仓库</h3><p>详见 <a href="https://tintgit.github.io/2017/08/09/CocoaPods/" target="_blank" rel="noopener">CocoaPods建立自己的Podspec</a></p>
<p>验证通过后 提交podspec 到私有spec repo</p>
<ul>
<li>pod repo push [本地名字] xx.podspec<br>成功后 在目录 ./cocoapods/repos 查看</li>
</ul>
<h3 id="集成测试"><a href="#集成测试" class="headerlink" title="集成测试"></a>集成测试</h3><ul>
<li>pod search xx</li>
<li>创建项目测试 </li>
</ul>
<ul>
<li><code>-</code> pod install 如果[!] Unable to find a specification for <code>xx</code> 因为默认是去公有的索引库查找<ul>
<li><strong>解决：</strong> 增加两个source  # 表示先去找私有，再找公有</li>
<li>source ‘<a href="https://git.xxx.cn/TestSpecs.git&#39;" target="_blank" rel="noopener">https://git.xxx.cn/TestSpecs.git&#39;</a></li>
<li>source ‘<a href="https://github.com/CocoaPods/Specs.git&#39;" target="_blank" rel="noopener">https://github.com/CocoaPods/Specs.git&#39;</a></li>
</ul>
</li>
</ul>
<ul>
<li>pod lib lint时 私有库中含有私有库 索引不到 需要添加 –sources=’私有仓库地址,<a href="https://github.com/CocoaPods/Specs.git&#39;" target="_blank" rel="noopener">https://github.com/CocoaPods/Specs.git&#39;</a></li>
<li>search 失败 可能同名覆盖 或者移除搜索映射：rm ~/Library/Caches/CocoaPods/search_index.json</li>
<li>pod update xx</li>
</ul>
<h3 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h3><ul>
<li>git status</li>
<li>更新 repo: pod repo update <code>REPO_NAME</code></li>
<li>git clean -f</li>
</ul>
<h3 id="Development-Pod"><a href="#Development-Pod" class="headerlink" title="Development Pod"></a>Development Pod</h3><h3 id="参考："><a href="#参考：" class="headerlink" title="参考："></a>参考：</h3><p>官方文档: <a href="http://guides.cocoapods.org/making/private-cocoapods.html" target="_blank" rel="noopener">Private Pods</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/06/11/Tips/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Unruly">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/assets/blogImg/mine.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Unruly的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/11/Tips/" itemprop="url">iOS 知识小集(1)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-11T00:00:00+08:00">
                2018-06-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/知识小集/" itemprop="url" rel="index">
                    <span itemprop="name">知识小集</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="struct-class"><a href="#struct-class" class="headerlink" title="struct - class"></a>struct - class</h3><p>在类中，当你对一个变量进行拷贝的时候，两个变量都指向内存中的同一个对象。两个中的任何一个变量中的改变都会影响另外一个变量（引用类型）。然而在结构体中，你是通过创建了一个新的对象（值类型）来实现简单的拷贝和复制的。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">StructPerson</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassPerson</span>: <span class="title">NSObject</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span> = <span class="string">""</span></span><br><span class="line">    <span class="keyword">init</span>(name: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.name = name</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MMStruct_ClassController</span>: <span class="title">UIViewController</span> </span>&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line">        <span class="keyword">let</span> class_p = <span class="type">ClassPerson</span>(name: <span class="string">"yanming"</span>)</span><br><span class="line">        <span class="built_in">print</span>(class_p.name)</span><br><span class="line">        <span class="keyword">let</span> new_class_p = class_p</span><br><span class="line">        new_class_p.name = <span class="string">"mengqi"</span></span><br><span class="line">        <span class="built_in">print</span>(class_p.name)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">let</span> struct_p = <span class="type">StructPerson</span>(name: <span class="string">"father"</span>)</span><br><span class="line">        <span class="built_in">print</span>(struct_p.name)</span><br><span class="line">        <span class="keyword">var</span> new_struct_p = struct_p</span><br><span class="line">        new_struct_p.name = <span class="string">"mother"</span></span><br><span class="line">        <span class="built_in">print</span>(struct_p.name)</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/* 输出结果</span></span><br><span class="line"><span class="comment">         yanming - mengqi - father - father</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/assets/blogImg/mine.jpg"
                alt="Unruly" />
            
              <p class="site-author-name" itemprop="name">Unruly</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">34</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">61</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/TintGit" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-globe"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://weibo.com/u/5027328866" target="_blank" title="微博">
                      
                        <i class="fa fa-fw fa-weibo"></i>微博</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.kalman03.com" title="kalman" target="_blank">kalman</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2016 &mdash; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Unruly</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
